## 数据库

### 数据模型

- 数据模型：实体类型及实体类型间联系的模型
- 数据模型分类
  - 概念数据模型
    - 实体
    - 属性 (.attribute)
    - 码（唯一标识实体的属性）
    - 域（属性的取值范围，options）
    - 实体型 （具有相同属性的实体，=实体名+属性名）
    - 实体集 （同型实体的集合）
    - 联系 实体之间的对应关系（E-R）
      - 实体-矩形
      - 属性-椭圆形
      - 联系-棱形
  - 结构数据模型（直接面向数据库的逻辑结构）
    - 任何一个DBMS（数据库管理系统）都以某个结构数据模型为基础。
    - 主要包括：层次（树结构）、网状（图结构）、关系（二维表格）、面向对象模型

### 三级模式结构、两级映像

- 外模式（视图） + 模式（基本表） + 内模式（存储文件）
  - 外模式是**用户和数据库系统**的接口
  - 概念模式反映数据库结构及其联系
  - 内模式是数据**物理结构和存储方式**的描述
- 两级映像保证了数据库中的数据具有较高的逻辑独立性和物理独立性
- 模式-内模式映像（**物理独立性**）、外模式-模式映像（**逻辑独立性**）。

### 关系模型

- 术语

  - 关系：对应一张**二维表**
  - 元组：表中一**行**，对应一个记录值
  - 属性：表中一**列** 对应字段
  - 域：属性的取值范围
  - 关系模式：对关系的描述 格式为`关系名(属性1，属性2，...，属性名n)` 
  - 候选码：属性或属性组合，能**唯一标识**一个元组
  - 主码：候选码中选一个作为主码
  - 主属性：包含在任何**候选码中属性**，不包含的是非主属性
  - 外码：一个关系的属性是**另一个关系**的码
  - 全码：关系模式的**所有**属性组是该关系的候选码
  - 超码：一个包含码的**属性集**称为超码

- 定义：`R(U, D, dom, F)`

  - R为关系名
  - U为该系的属性名集合
  - D为属性组U中属性所来自的域
  - dom为属性向域的映像集合
  - F为属性见数据的依赖关系集合

- 组成：关系数据结构+关系操作集合+关系完整性约束

  - 关系数据结构：一张二维表格
  - 关系操作集合：选择、投影等...
  - 完整性约束：实体完整性 + 参照完整性 + 用户定义的完整性
    - 实体完整性：主属性不为空（能够被唯一标识）
    - 参照完整性：外码能在对应表中被找到（外码能找到）
    - 用户定义的完整性：用户对某一数据指定约束条件进行校验。（用户自定义校验）

- 集合运算符

  - 笛卡尔积 x

    > D1 = { 0, 1 }
    >
    > D2 = { a, b, c }
    >
    > D1 x D2 = { (0, a), (0, b), (0, c), (1, a), (1, b), (1, c) }
  - 并 ∪
  
    - `R ∪ S` 所有元组合并，**删除重复元组**
  - 差 `-`
  
    - `R - S` 属于R 不属于S的所有元组
  - 交 `∩`
  
    - `R ∩ S` 既属于R又属于S的元组集合
  
- 关系运算符

  - 投影 `π`

    - 关系的**垂直**方向进行运算，选择若干属性组成新的关系
  
      ![image-20250114215819229](./assets/image-20250114215819229.png)
  
  - 选择 `σ`
  
    - 关系的**水平**方向进行运算，选择满足给定条件的元组
  
      ![image-20250114215917732](./assets/image-20250114215917732.png)
  
  - 连接`⋈`
  
    - `θ`连接：从R与S的笛卡尔积中选取属性间满足一定条件的元组。
  
      ![image-20250114220138646](./assets/image-20250114220138646.png)
  
    - 等值连接：当θ为`=`时
  
      ![image-20250114220433035](./assets/image-20250114220433035.png)
  
    - 自然连接：**除去重复属性**的等值连接。
  
      - 计算`R x S`
      - 根据等值条件筛选**公共属性相同**的元组
      - 去除相同的列（公共属性）
  
      ![image-20250114220629500](./assets/image-20250114220629500.png)
  
    - 外连接：是对连接运算的扩展，处理由于连接运算缺失的信息
      - 左外连接`⟕` ，以运算符左侧为准，自然连接后用null填充来自右侧关系的属性
      - 右连接`⟖`，同上，以右侧运算符为准
      - 全外连接`⟗`，既做左连接，也做右连接，合并结果
  
    > 其实自然连接达到的目的是 根据A表进行B表的关联查询 ，但是由于只做等值查询，舍弃了A表中没有关联B表的其他数据。
    >
    > 左连接解决该问题，将未关联的元组属性填写为null
    >
    > 右连接反之，以右侧为主
  
  - 除 `÷`